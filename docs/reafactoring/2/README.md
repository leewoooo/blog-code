# 리팩터링 2장

## 2.1 리팩터링 정의

수많은 다른 소프트웨어 개발 용어와 마찬가지로 **리팩터링**도 엔지니어들 사이에서 다소 두루뭉실한 의미로 통용된다.

리팩터링은 명서 혹은 동사로 사용될 수 있는데 책에서 정의하는 것은 아래와 같다.

<br>

> 명사: 소프트웨어의 겉보기 동작은 그대로 유지한 채, 코드를 이해하고 수정하기 쉽도록 내부 구조를 변경하는 기법 <br>동사: 소프트웨어의 겉보기 동작은 그대로 유지한 채, 여러가지 리팩터링 기법을 적용해서 소프트웨어를 재구성하다.

<br>

책에서 이야기 하기를 코드를 정리하는 작업이 모조리 **리팩터링**이라고 생각할 수 있지만 **특정한 방식에 따라 코드를 정리하는 것만이 리팩터링이라고 말한다.**

코드베이스를 정리하거나 구조를 바꾸는 모든 작업을 **재구성**이라 하고 리팩터링은 재구성 중 **특수한 한 형태로 생각한다는 것이다.**

여기서 중요한 점은 **리팩터링을 하기 전과 후가 동일하게 동작을 해야한다는 것이다.** -> 내부적으로 성능 혹은 코드가 변하더라도 **클라이언트 관점에서는 사용할 때 달라지면 안된다는 것이다.**

정리하자면 리팩터링의 목적은 **코드를 이해하고 수정하기 쉽게 만드는 것이다.**

<br>

## 2.2 두개의 모자

개발을 할 때 목적을 아래와 같이 나눌 수 있다.

1. 기능 추가

2. 리팩터링

<br>

기능을 추가할 때는 `기능 추가` 모자를 쓴 다음 기존 코드는 **절대 건드리지 않고 새 기능만 추가한다.**

리팩터링을 할 때는 `리팩터링` 모자를 쓴 다음 **기능 추가는 절대 하지 않기로 다짐한 뒤 오로지 코드 재구성에만 전념한다.**

<br>

## 2.3 리팩터링하는 이유

리팩토링이 소프트웨어의 모든 문제점을 해결하는 만병통치약은 아니지만 코드를 건강한 상태로 유지하는 데 도와주는 약이다.

<br>

### 리팩터링을 하면 소프트웨어 설계가 좋아진다.

리팩터링을 하지 않으면 소프트웨어 내부 설계(아키택처)가 썩기 쉽다. **단기 목표만을 위해 코드를 수정하다 보면 기반이 무너지기 쉽다.**

코드만 봐서는 설계를 파악하기 어려워지며, 어려워질수록 설계를 유지하기 어려워지고, 설계가 부패되는 속도는 빨라진다.

그렇기 때문에 규칙적인 리팩터링이 필요하게 된다.

<br>

### 리팩터링하면 소프트웨어를 이해하기 쉬워진다.

프로그래밍은 내가 원하는 바를 정확히 코드로 표현하는 일이다. 내가 원하는 바를 코드로 작성하여 컴퓨터에게 시키는 것이다.

하지만!

내가 작성한 코드를 컴퓨터만 사용하는 것이 아니라 같이 협업을 하게 되는 **동료들도 사용을하게 된다.**

리팩터링은 **코드가 더 잘 읽히게 도와준다.** 단지 다른 사람을 배려하기 위해서가 아니다. 사실 **그 다른 사람이 바로 자기 자신일 때가 많다.**

<bt>

### 리팩터링하면 버그를 쉽게 찾을 수 있다.

코드를 이해하기 쉽다는 말은 버그를 찾기 쉽다는 말이기도 하다.

**프로그램의 구조를 명확하게 다듬으면 그냥 '이럴 것이다' 라고 가정하던 점들이 분명하게 드러나고, 버그를 지나치려야 지나칠 수 없을 정도꺼지 명확해진다.**

<br>

### 리팩터링하면 프로그래밍 속도를 높일 수 있다.

리팩터링을 하면 품질을 높일 수 있다는 점에는 대부분 쉽게 수긍한다. 그 이유는 내부적으로 설계와 가독성이 개선되고 버그가 줄어들기 때문이다.

하지만 리팩터링하는 데 시간이 들기 때문에 개발 속도가 떨어질까봐 걱정할 수도 있다.

한 시스템을 오래 개발하다보면 초기에는 진척이 빨랐지만 현재는 새 기능을 추가하려면 오래걸린다는 말을 하게 된다. (새로운 기능을 현재 코드 베이스에 녹여내기 힘들다는 뜻.) -> 최종으로는 새로 개발하는 편이 좋겠다는 생각까지 이르게 된다.

리팩터링을 통해 품질을 높인 것과 높이지 않은 것을 보여주는 그래프는 아래와 같다.

<img src = https://user-images.githubusercontent.com/74294325/169425233-4bbf8bcf-51bf-44b0-8b84-22fc957789d5.png>

<br>

모듈화가 잘 되어 있으면 전체 코드베이스 중 작은 일부만 이해하면 된다. 코드가 명확하기 때문에 버그를 만들 가능성이 줄어들고, 새 기능 구축을 돕는 견고한 토대가 된다.

설계를 잘하려면 코딩을 시작하기 전에 설계부터 완벽히 마쳐야 한다는 생각이 있지만 **리팩터링**이 존재하기 때문에 개발을 진행하면서 **요구사항이 변경되거나 설계가 변경되더라도 유연하게 대처할 수 있게 되는 것이다.**
